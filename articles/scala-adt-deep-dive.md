---
title: "ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹Deep Dive in Scala"
emoji: "ğŸ™"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Scala", "é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹", "ADT"]
published: false
---


## ã¯ã˜ã‚ã«
é–¢æ•°å‹ã‚„ã£ã¦ã‚‹ã¨ã‚ˆãèãä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹(ADT)ã«ã¤ã„ã¦ã€‚
Scalaã‚„ã£ã¦ã‚‹ã¨ã‚ˆãä½¿ã†ãŒHaskellã»ã©ã“ã®è©±é¡Œã«ã¤ã„ã¦æ˜ã£ãŸè¨˜äº‹ã¯ã‚ã‚“ã¾ã‚Šãªã„ã®ã§digã£ã¦ã„ããŸã„ã€‚

## ãã‚‚ãã‚‚ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¨ã¯
### å…·ä½“ä¾‹
ã“ã†ã„ã†ã‚„ã¤ã€‚

```scala
sealed trait Animal
case class Dog(name: String, age: Int) extends Animal
case class Cat(color: String) extends Animal
```

### ãªãœä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¨ã„ã†ã®ã‹
ãƒ‡ãƒ¼ã‚¿å‹ã‚’ã‚ã‚‹ç¨®ä»£æ•°=è¨ˆç®—å¯¾è±¡ã¨ãã®ä¸Šã®æ¼”ç®—ãƒ»æ³•å‰‡ã«å¯¾å¿œã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã§ã‚ã‚‹ã€‚
ä¾‹ãˆã°ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¨ã—ã¦å®šç¾©ã•ã‚ŒãŸã‚‚ã®ã¯è¶³ã—ç®—ã‚„æ›ã‘ç®—ã®æ§˜ãªã‚‚ã®ã«å¯¾å¿œã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
è©³ã—ãã¯å¾Œè¿°ã™ã‚‹ã€‚


## ä»£æ•°å‹ãƒ‡ãƒ¼ã‚¿å‹ã®æ§‹æˆè¦ç´ 
## ç›´å’Œå‹
ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§è¡¨ã•ã‚Œã‚‹ã‚‚ã®ã€‚

```scala
sealed trait A
case class B(v: Int) extends A
case object C extends A
```

ã“ã“ã§`A`ã¨ã„ã†å‹ã¨ã—ã¦ã‚ã‚Šãˆã‚‹å…·ä½“å‹ã¯ã€`B`ã¾ãŸã¯`C`ã¨ã¿ãªã›ã‚‹ã€‚
ãªãœãªã‚‰ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯`A`ã¯ç¶™æ‰¿ã§ããªã„ã—ã€`new A {}`ã®ã‚ˆã†ã«ç›´æ¥ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã™ã‚‹ã“ã¨ã‚‚ã§ããªã„ã€‚
(åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§`new A {}`ã™ã‚‹ã“ã¨ã¯ã§ãã‚‹ã£ã½ã„ãŒãã‚Œã¯ãªã—ã®æ–¹å‘ã§)
æ•…ã«`A`ã¨ã—ã¦ã‚ã‚Šãˆã‚‹å€¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ã¯ã€Œ`B`ã¨ã—ã¦ã‚ã‚Šãˆã‚‹å€¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°+`C`ã¨ã—ã¦ã‚ã‚Šãˆã‚‹å€¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°ã€ã«ç­‰ã—ã„ã€‚
ãã—ã¦`B`ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å†…éƒ¨ã®Intã®ãƒ‘ã‚¿ãƒ¼ãƒ³æ•°2^32ã«ç­‰ã—ã`C`ã¯å”¯ä¸€`C`ã ã‘ãŒã‚ã‚Šãˆã‚‹å€¤ã§ã‚ã‚‹ã€‚
çµæœã¨ã—ã¦å‹ã«å¯¾å¿œã™ã‚‹ã‚ã‚Šãˆã‚‹å€¤ã®æ•°ã‚’äºŒé‡ç·šæ–‡å­—ã§æ›¸ããªã‚‰ã°ã€

$$
\begin{aligned}
{\Bbb A} &= \Bbb B + \Bbb C \\
        &= 2^{32} + 1
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
Aã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦å…·ä½“ä¾‹ã‚’æŒ™ã’ã‚‹ã¨ã€
`C`ã€`B(-2147483648)`ã€â€¦ã€`B(2147483647)`
ã¨ç¢ºã‹ã«2^32 + 1å€‹ã‚ã‚‹ã€‚

ã“ã®æ§˜ã«ç›´å’Œå‹ã¨è¨€ã‚ã‚Œã‚‹ã‚‚ã®ã®å€¤ã®æ•°ã¯ãã®ã‚µãƒ–å‹ã®å€¤ã®æ•°ã®å’Œã«ã‚ˆã£ã¦æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚
ä»£æ•°çš„æ¼”ç®—ã¨ã—ã¦ã¯è¶³ã—ç®—ã«å¯¾å¿œã™ã‚‹ã€‚
ã—ã‹ã‚‚ãã®ã‚µãƒ–å‹åŒå£«ã«è¢«ã‚Šã¯ãªãã€é›†åˆè«–ã®ç›´å’Œé›†åˆã«å¯¾å¿œã—ã¦ã„ã‚‹ã€‚

ã“ã‚Œã¯ä»®ã«`A`ã¨ã—ã¦ã‚ã‚Šãˆã‚‹å€¤ãŒ`B`ã€`C`ã€`D`ã€â€¦ã¨å¢—ãˆã¦ã„ã£ã¦ã‚‚åŒã˜ã§ã‚ã‚‹ã€‚

ä»¥ä¸‹å‹ã«å¯¾å¿œã™ã‚‹å€¤ã®æ•°ã‚’ãã®å‹ã®äºŒé‡ç·šæ–‡å­—ã§è¡¨ç¾ã™ã‚‹ã€‚

## ç›´ç©å‹
å’Œã«åŠ ãˆã¦ç©ãŒã‚‚ã†ä¸€ã¤ã®æ§‹æˆè¦ç´ ã«ãªã‚‹ã€‚
å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã‚ã‚‹ã€‚

```scala
case class B(v: Int)
object C
case class A(b: B, c: C)
```

ã“ã“ã§$\Bbb A$ã‚’è€ƒãˆã¦ã¿ã‚ˆã†ã€‚
Aã¯ï¼’ã¤ã®è¦ç´ bã¨cã«ã‚ˆã£ã¦ãªã‚‹ã€‚
ã¤ã¾ã‚Šbã®ä»»æ„ã®è¦ç´ ã«å¯¾ã—ã¦cã®ä»»æ„ã®è¦ç´ ã®çµ„ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã€ãã®æ•°ã¯$\Bbb B \times \Bbb C$ã«ç­‰ã—ã„ã€‚
ã‚ˆã£ã¦ã€

$$
\begin{aligned}
\Bbb A &= \Bbb B * \Bbb C \\
        &= 2^{32} * 1 \\
        &= 2 ^ {32}
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
`A`ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã—ã¦å…·ä½“ä¾‹ã‚’æŒ™ã’ã‚‹ã¨ã€
`A(B(-2147483648), C)`ã€â€¦ã€`A(B(2147483647), C)`
ã¨ç¢ºã‹ã«2^32é€šã‚Šã«ãªã£ã¦ã„ã‚‹ã€‚

ç›´ç©å‹ã®å€¤ã®æ•°ã¯ãã‚Œã‚’ãªã™å‹ã®æ•°ã®ç©ã«ã‚ˆã£ã¦æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚
ä»£æ•°çš„æ¼”ç®—ã¨ã—ã¦ã¯æ›ã‘ç®—ã«å¯¾å¿œã™ã‚‹ã€‚

ã“ã‚Œã¯ä»®ã«`A`ã‚’ãªã™è¦ç´ ãŒ`B`ã€`C`ã€`D`ã€â€¦ã¨å¢—ãˆã¦ã„ã£ã¦ã‚‚åŒã˜æ§˜ã«ãã‚Œã‚‰ã®ç©ã‚’ã™ã‚Œã°ã„ã„ã ã‘ã§ã‚ã‚‹ã€‚

### ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã®æ§‹é€ 
ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¯çµå±€ä¸€ç•ªæœ€åˆã«å‡ºã—ãŸä¾‹ã®ã‚ˆã†ã«ç›´å’Œã¨ã—ã¦è¡¨ç¾ã•ã‚Œã‚‹ã€‚
ãã—ã¦ãã®ã‚µãƒ–å‹ã¯ç›´ç©ã§ã‚ã‚‹ãŸã‚ã—ã°ã—ã°ã€Œç›´ç©ã®ç›´å’Œã€ã‚„ã€ã€Œç›´ç©ã®ç·å’Œã€ãªã©ã¨è¡¨ç¾ã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚


## ãƒ‡ãƒ¼ã‚¿å‹ã¨ä»£æ•°
ãªã‚“ã¨ãªããƒ‡ãƒ¼ã‚¿å‹ã‚’ä½¿ã£ãŸè¶³ã—ç®—ã¨æ›ã‘ç®—ãŒã‚ã‹ã£ãŸã®ã§ã€é »å‡ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ãŒä»£æ•°çš„ã«ã¯ä½•ã«å¯¾å¿œã™ã‚‹ã‹ã‚’è¦‹ã¦ã„ã“ã†ã¨æ€ã†ã€‚

### Nothing=0
`Nothing`ã¯å€¤ãŒãªã„ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹å‹ã§ã€ä¾‹å¤–ã‚’å°„å‡ºã™ã‚‹ã¨ããªã©ã«ä½¿ç”¨ã™ã‚‹ã€‚
å€¤ãŒãªã„ã®ã ã‹ã‚‰0ã§ã‚ã‚‹ã€‚

### Unit=1
Scalaã®`Unit`ã¯å”¯ä¸€ã¤ã®å€¤`()`ã‚’æŒã¤ãŸã‚1ã«å¯¾å¿œã™ã‚‹ã€‚
åŒã˜æ§˜ã«objectãªã©ã®ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãŸã¡ã‚‚1ã«å¯¾å¿œã™ã‚‹ã€‚

### Boolean=2
`Boolean`ã¯`true`ã‚‚ã—ãã¯`false`ã®ï¼’å€¤ã€‚
ã‚ˆã£ã¦2ã€‚

### Option[T]=T+1
`Option[T]`ã¯`Some(T)`ã‚‚ã—ãã¯`None`ã§ã‚ã‚‹ã€‚
`Some`ã¯å˜é …ç›´ç©ã§ãã®ã¾ã¾ä¸­èº«ã®å€¤ã®ç¨®é¡ã«ä¾å­˜ã™ã‚‹ãŸã‚$\Bbb T$ã§ã‚ã‚ŠNoneã¯ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã§ã‚ã‚‹ã‹ã‚‰ã€

$$
\begin{aligned}
\Bbb Option[T] &= \Bbb T + 1
\end{aligned}
$$

ã§ã‚ã‚‹ã€‚

### Either[A, B]=A+B
`Either`ã¯`Left`ã‚‚ã—ãã¯`Right`ã§ã‚ã‚Šã©ã¡ã‚‰ã‚‚å˜é …ç›´ç©ã§ã€

$$
\Bbb Either[A, B] = \Bbb A + \Bbb B
$$

ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯æœ€ã‚‚å˜ç´”ãªç›´å’Œã§ã‚ã‚Šã€ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã®ä¾‹ã¨ã—ã¦ã‚ˆãè¦‹ã‚‹ã€‚

ã¾ãŸä»®ã«$\Bbb B = 1$ã€ä¾‹ãˆã°`B`ãŒ`Unit`ã§ã‚ã‚‹ã‚ˆã†ãªã¨ãã¯ã€

$$
\begin{aligned}
\Bbb Either[A, Unit] &= \Bbb A + 1 \\
                      &= \Bbb Option[A]
\end{aligned}
$$

ã¨ãªã‚Šã“ã‚Œã¯`Either[A, Unit]`ã¨`Option[A]`ãŒåŒã˜è¡¨ç¾åŠ›ã‚’æŒã¤ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚
ç¢ºã‹ã«æ‰±ã„ã‚„ã™ã•ã‚’åˆ¥ã«ã™ã‚Œã°`Right[Unit]`ã§ã‚ã‚‹ã“ã¨ã‚’`None`ã«ã€`Left[A]`ã§ã‚ã‚‹ã“ã¨ã‚’`Some[A]`ã«å¯¾å¿œã•ã›ã‚Œã°åŒã˜ã“ã¨ãŒè¡¨ç¾ã§ãã‚‹ã€‚

ä»–ã«ã‚‚ã€`Either[A, Nothing]`ãªã‚‹ã‚‚ã®ã‚’è€ƒãˆã‚Œã°ã€

$$
\begin{aligned}
\Bbb Either[A, Nothing] &= \Bbb A + 0 \\
                        &= \Bbb A
\end{aligned}
$$


ã¨ãªã‚Šå˜ãªã‚‹`A`ã«ç­‰ã—ã„ã€‚
`Right`ã¯èµ·ã“ã‚Šå¾—ãªã„ã®ã ã‹ã‚‰ãã‚Œã‚‚ãã†ã§ã‚ã‚‹ã€‚

### Tuple2[A, B]=A*B
ã‚¿ãƒ—ãƒ«ã¯ä»»æ„ã®å‹ã®çµ„ã¿åˆã‚ã›ã‚’è¡¨ç¾ã™ã‚‹ã“ã¨ãŒã§ãã€ã“ã‚Œã¯æœ€ã‚‚å˜ç´”ãªç›´ç©ã§ã‚ã‚‹ã€‚
ã¤ã¾ã‚Šã€

$$
\Bbb Tuple2[A, B]=A*B
$$

ã‚¿ãƒ—ãƒ«ã®è¦ç´ ãŒ2ã€3ã€â€¦ã¨å¢—ãˆã¦ã„ã‘ã°æ›ã‘ç®—ã®é …ãŒå¢—ãˆã¦ã„ãã ã‘ã€‚

ã¾ãŸä»®ã«`B`=`Nothing`ã®ã¨ãã¯ã€

$$
\begin{aligned}
\Bbb Tuple2[A, Nothing] &= \Bbb A * 0 \\
                        &= 0 \\
                        &= \Bbb Nothing
\end{aligned}
$$

`Nothing`ãŒå…¥ã£ãŸç¬é–“ã«å­˜åœ¨ã™ã‚‹å€¤ãŒãªã„ã®ã ã‹ã‚‰ãã‚Œã¯ãã†ã€‚

ä»–ã«ã‚‚`B`=`Unit`ã¨ã™ã‚‹ã¨ã€

$$
\begin{aligned}
\Bbb Tuple2[A, Unit] &= \Bbb A * 1 \\
                    &= \Bbb A
\end{aligned}
$$

ã“ã‚Œã‚‚ç‰‡æ–¹ã‚’`()`ã«å›ºå®šã—ã¦`A`ã®å€¤ã‚’å‹•ã‹ã—ã¦ã„ãã ã‘ãªã®ã§è¡¨ç¾åŠ›ã¨ã—ã¦ã¯åŒã˜ãªã®ã¯è…‘ã«è½ã¡ã‚‹ã€‚


## ä»£æ•°ã«ã¤ã„ã¦
ã“ã“ã¾ã§çµæ§‹é©å½“ã«ä»£æ•°ã¨ã„ã†ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ããŸãŒã€ä»Šä¸€åº¦ä»£æ•°ã¨ã¯ãªã«ã‹ã¨ã„ã†éƒ¨åˆ†ã‚’è¦‹ã¦ã„ããŸã„ã€‚

### ä»£æ•°ã®æ§‹æˆ
ã¾ãšä»£æ•°ã‚’ãªã™è¦ç´ ã‹ã‚‰è¦‹ã¦ã„ãã€‚
ã€Œä»£æ•°ã€ã¨ã¯ç°¡å˜ã«è¨€ãˆã°æ¬¡ã®ï¼“ã¤ã®è¦ç´ ã‹ã‚‰ãªã‚‹ã‚‚ã®ã§ã‚ã‚‹ã€‚

1. ä½•ã‚‰ã‹ã®é›†åˆA
2. é›†åˆAã®ä¸Šã§ã®æ¼”ç®—ã®é›†ã¾ã‚Š
3. æ¼”ç®—ãŒæº€ãŸã™ã¹ãæ³•å‰‡

ã“ã‚Œã‚‰ï¼“ã¤ã‚’å‚™ãˆãŸã‚‚ã®ã‚’ä»£æ•°ã¨ã‹ä»£æ•°ç³»ã¨ã‹å‘¼ã‚“ã ã‚Šã™ã‚‹ã€‚
ã¾ãŸã“ã“ã§ã„ã†é›†åˆAã‚’underlyingã¨ã‹å°é›†åˆã¨ã‹å‘¼ã‚“ã ã‚Šã™ã‚‹ã€‚
ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã¯é›†åˆAãŒåœŸå°ã¨ãªã£ã¦ã€ãã®ä¸Šã§ä½•ã‚‰ã‹ã®æ¼”ç®—ãŒå®šã¾ã‚Šã€ãã‚Œã‚‰ãŒæ³•å‰‡ã‚’æº€ãŸã—ãªãŒã‚‰æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†æ„Ÿã˜ã€‚

### ä»£æ•°ã®å…·ä½“ä¾‹
ä»£æ•°ã®æ§‹æˆã®å®šç¾©ã ã‘è¦‹ã¦ã‚‚ãªã‚“ã®ã“ã£ã¡ã‚ƒã‚ã‹ã‚‰ãªã„ã®ã§å…·ä½“ä¾‹ã‚’è¦‹ã¦ã„ãã€‚
ä¸‹ã«ä¸Šã’ãŸã‚‚ã®ä»¥å¤–ã«ã‚‚è‰²ã€…å­˜åœ¨ã™ã‚‹

#### Semigroup(åŠç¾¤)
Catsã¨ã‹ä½¿ã†ã¨è¦‹ãŸã“ã¨ã‚ã‚‹åå‰ã ã¨æ€ã†ã€‚
Semigroupã¯ã€

1. ä½•ã‚‰ã‹ã®é›†åˆAãŒã‚ã£ã¦
2. ãã®ä¸Šã§ãªã‚“ã‚‰ã‹ã®äºŒé …æ¼”ç®—å­$*: A \times A \to A$ãŒå®šã¾ã£ã¦ã„ã¦
3. Aã®ä»»æ„ã®è¦ç´ a,b,cã«å¯¾ã—ã¦$(a*b)*c = a*(b*c)$ãŒæˆã‚Šç«‹ã£ã¦ã„ã‚‹(çµåˆå‰‡)

ã¨ãã€`(A, *)`ã®çµ„ã‚’Semigroupã¨å‘¼ã¶ã€‚
ã“ã‚Œã‚‚ã¾ãŸä»£æ•°ã®å…·ä½“ä¾‹ã«ã—ã¦ã¯æŠ½è±¡çš„ãªã®ã§ã‚‚ã£ã¨å…·ä½“åŒ–ã—ã¦ã¿ã‚‹ã€‚
Semigroupã¨ã„ã£ã¦ã‚‚å®Ÿéš›ã«Semigroupã«ãªã‚‹ã‚ˆã†ãªã‚‚ã®ã¯ã„ãã¤ã‹ã‚ã£ã¦ã€ä¾‹ãˆã°è‡ªç„¶æ•°ã®é›†åˆNã¨ãã®ä¸Šã§ã®è¶³ã—ç®—+ã®çµ„(N, +)ã¯Semigropuã«ãªã£ã¦ã„ã‚‹ã€‚
ãªãœãªã‚‰ä»»æ„ã®è‡ªç„¶æ•°aã€bã€cã«å¯¾ã—ã¦ã€$(a + b) + c = a + (b + c)$ã¨ãªã‚‹ã‹ã‚‰ã ã€‚
ã¡ãªã¿ã«åŒæ§˜ã«æ›ã‘ç®—ã«å¯¾ã—ã¦ã‚‚Nã¯Semigroupã‚’ãªã™ãŒã€å‰²ã‚Šç®—ã‚„å¼•ãç®—ã«å¯¾ã—ã¦ã¯çµæœãŒè‡ªç„¶æ•°ã«åã¾ã‚‰ãªã„ã®ã§ãã‚Œã‚‰ã«å¯¾ã—ã¦ã¯Semigroupã‚’ãªã•ãªã„ã€‚

#### Monoid
Semigroupã¨ã»ã¨ã‚“ã©åŒã˜ã€‚
é•ã†ã®ã¯æ¬¡ã®å®šç¾©ã§å®šã¾ã‚‹å˜ä½å…ƒã‚’æŒã¤ã‹ã©ã†ã‹ã€‚

- å˜ä½å…ƒã¨ã¯ã€å°é›†åˆAã®ä»»æ„ã®è¦ç´ aã«å¯¾ã—ã¦ã€$e*a = a*e = a$ã¨ãªã‚‹ã‚ˆã†ãªAã®è¦ç´ eã®ã“ã¨

ç°¡å˜ã«è¨€ã†ã¨ãã®è¦ç´ ã¨åˆ¥ã®è¦ç´ ã®è¨ˆç®—ãŒãã®å€¤ã‚’å¤‰åŒ–ã•ã›ãªã„ã‚ˆã†ãªã‚‚ã®ã§ã‚ã‚‹ã€‚
è‡ªç„¶æ•°ã®ä¸Šã§ã®è¶³ã—ç®—ã®å ´åˆã¯0ã€è‡ªç„¶æ•°ã®ä¸Šã§ã®æ›ã‘ç®—ã¯1ãŒãã‚Œã«å¯¾å¿œã™ã‚‹ã€‚


## ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ãŒãªã™ä»£æ•°
ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¯ã©ã‚“ãªä»£æ•°çš„æ§‹é€ ãŒç¾ã‚Œã¦ãã‚‹ã‹è¦‹ã¦ã„ããŸã„ã€‚

### ç›´å’Œ
ç›´å’Œã¨ã—ã¦å˜ç´”ãª`Either[A, B]`ã‚’è¦‹ã¦ã„ãã€‚
ä¾‹ãˆã°ã€

$$
\begin{aligned}
\Bbb Either[Either[A, B], C] &= (\Bbb A + \Bbb B) + \Bbb C \\
                            &= \Bbb A + (\Bbb B + \Bbb C) \\
                            &= \Bbb Either[A, Either[B, C]]
\end{aligned}
$$

ã¨ãªã‚‹ã®ã§`Either`ã¯çµåˆå‰‡ã‚’æº€è¶³ã™ã‚‹ã€‚
æ›´ã«ã€

$$
\begin{aligned}
\Bbb Either[Nothing, A] &= 0 + \Bbb A \\
                        &= \Bbb A \\
                        &= \Bbb A + 0 \\
                        &= \Bbb Either[A, Nothing]
\end{aligned}
$$

ã¨ãªã‚‹ã®ã§`Either`ã¯å˜ä½å…ƒ`Nothing`ã‚’æŒã¤ã€‚
åŠ ãˆã¦ã€

$$
\begin{aligned}
\Bbb Either[A, B] &= \Bbb A + \Bbb B \\
                    &= \Bbb B + \Bbb A \\
                    &= \Bbb Either[B, A]
\end{aligned}
$$

ã‚ˆã‚Š`Either`ã¯å¯æ›ã§ã‚‚ã‚ã‚‹ã€‚

ä»¥ä¸Šã‹ã‚‰`Either`ã¯å¯æ›Monoidã®æ€§è³ªã‚’æŒã¤ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

### ç›´ç©
`Tuple2[A, B]`ã‚’è€ƒãˆã‚‹ã€‚
ä¾‹ãˆã°

$$
\begin{aligned}
\Bbb Tuple2[A, Tuple2[B, C]] &= \Bbb A * (\Bbb B * \Bbb C) \\
                            &= \Bbb A * \Bbb B * \Bbb C \\
                            &= (\Bbb A * \Bbb B) * \Bbb C \\
                            &= \Bbb Tuple2[Tuple2[A, B], C]
\end{aligned}
$$

ã§ã‚ã‚‹ã‹ã‚‰`Tuple2[A, B]`ã¯çµåˆå‰‡ã‚’æº€è¶³ã—ã¦ã„ã‚‹ã€‚
æ›´ã«ã€

$$
\begin{aligned}
\Bbb Tuple2[A, Unit] &= \Bbb A * 1 \\
                    &= \Bbb A \\
                    &= 1 * \Bbb A \\
                    &= Tuple2[Unit, A]
\end{aligned}
$$


ã¨ãªã‚Š`Tuple2[A, B]`ã¯å˜ä½å…ƒ`Unit`ã‚’æŒã¤ã€‚
ã¾ãŸã‚¼ãƒ­å€¤ã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã‚‹ã¨ã€

$$
\begin{aligned}
Tuple2[A, Nothing] &= \Bbb A * 0 \\
                    &= 0 \\
                    &= 0 * \Bbb A \\
                    &= \Bbb Nothing
\end{aligned}
$$

ã¨ãªã‚‹ã®ã§ã€`Nothing`ãŒã‚¼ãƒ­å€¤ã¨ã—ã¦æŒ¯ã‚‹èˆã†ã€‚

### ç›´ç©ã¨ç›´å’Œ
ç›´ç©ã¨ç›´å’Œã®é–“ã®é–¢ä¿‚ã«ã¤ã„ã¦ã‚‚è¦‹ã¦ã„ãã€‚
ä¾‹ãˆã°ä»¥ä¸‹ã®æ§˜ãªã“ã¨ãŒæˆã‚Šç«‹ã¤ã€‚

$$
\begin{aligned}
\Bbb Tuple2[A, Either[B, C]] &= \Bbb A * (\Bbb B + \Bbb C) \\
                            &= \Bbb A * \Bbb B + \Bbb A * \Bbb C \\
                            &= \Bbb Either[Tuple2[A, B], Tuple2[A, C]]
\end{aligned}
$$

é †ç•ªã‚’é€†ã«ã—ã¦ã‚‚è¨ˆç®—ã™ã‚‹ã¨åŒæ§˜ã«

$$
\Bbb Tuple2[Either[A, B], C] = \Bbb Either[Tuple2[A, C], Tuple2[B, C]]
$$

ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚
ã“ã®æ§˜ãªé–¢ä¿‚ã‚’åˆ†é…æ³•å‰‡ã¨ã„ã†ã€‚

### Semiring
ä»¥ä¸Šã‹ã‚‰ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¯ä»¥ä¸‹ã®æ€§è³ªã‚’æŒã¤ã“ã¨ãŒã‚ã‹ã£ãŸã€‚

1. å’Œ(`Either[A, B]`)ã«ã¤ã„ã¦å¯æ›Monoidã‚’ãªã™
2. ç©(`Tuple2[A, B]`)ã«ã¤ã„ã¦Monoidã‚’ãªã™
3. ç©ã«ã‚¼ãƒ­å€¤ãŒå­˜åœ¨ã™ã‚‹
4. ç©ã¯å’Œã®ä¸Šã§åˆ†é…çš„ã«æŒ¯ã‚‹èˆã†

ä»¥ä¸Šã®æ€§è³ªã‚’æº€ãŸã™ä»£æ•°çš„æ§‹é€ ã‚’Semiring(åŠç’°)ã¨ã„ã†ã€‚
ã¤ã¾ã‚Šä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¯Semiringæ§‹é€ ã‚’ãªã™ã€‚
ã“ã‚ŒãŒä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ãŒ`ä»£æ•°çš„`ã¨è¨€ã‚ã‚Œã‚‹æ‰€ä»¥ã§ã‚ã‚‹ã€‚


## ãƒ‡ãƒ¼ã‚¿å‹ã§è¡¨ã•ã‚Œã‚‹ãã®ä»–ã®è¨ˆç®—æ§‹é€ 
ä»¥å‰ã®ç¯€ã§ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¨ä»£æ•°ã«ã¤ã„ã¦ã®è©±ã¯çµ‚ã‚ã£ãŸãŒã€ä»–ã®ãƒ‡ãƒ¼ã‚¿ãŒã§è¡¨ã•ã‚Œã‚‹è¨ˆç®—æ§‹é€ ã«ã¤ã„ã¦ã‚‚ã¤ã„ã§ãªã®ã§è¦‹ã¦ã„ãã€‚

### é–¢æ•°
#### è¡¨ç¾
é–¢æ•°ã®å‹ã¯æŒ‡æ•°ã«å¯¾å¿œã™ã‚‹ã€‚
ã¤ã¾ã‚Šã€

$$
\Bbb A => \Bbb B = \Bbb B ^ {\Bbb A}
$$

ã§ã‚ã‚‹ã€‚
ã“ã‚Œã¯é›†åˆè«–ã‚’ã¡ã‚‡ã£ã¨ã‹ã˜ã£ãŸäººãªã‚‰è¦‹ãŸã“ã¨ãŒã‚ã‚‹ã¨æ€ã†ã€‚
ãªãœã“ã†ãªã‚‹ã‹è¦‹ã¦ã„ã“ã†ã€‚
`A => B`ã¯Aå‹ã®å„ã€…ã®å€¤ã«Bå‹ã®ã‚ã‚‹å€¤ã‚’ç´ä»˜ã‘ã‚‹æ“ä½œã ã¨ã¿ãªã™ã“ã¨ãŒã§ãã‚‹ã€‚
ãã—ã¦ãã®ç´ä»˜ã‘æ–¹æ³•ã¯$\Bbb B$é€šã‚Šã‚ã‚‹ã€‚
$\Bbb B$é€šã‚Šã®ç´ä»˜ã‘æ–¹æ³•ãŒAã®è¦ç´ åˆ†=$\Bbb A$ã ã‘å­˜åœ¨ã™ã‚‹ã‹ã‚‰ã€ãã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã¯$\Bbb B * \Bbb B * â€¦ * \Bbb B = \Bbb B ^ \Bbb A$ã§ã‚ã‚‹ã€‚

#### Unitã‚’å«ã‚“ã è¨ˆç®—
é–¢æ•°è¡¨ç¾ã®æŒ‡æ•°ã‚’ä½¿ã£ã¦ã¡ã‚‡ã£ã¨éŠã‚“ã§è¦‹ã‚‹ã€‚

ã¾ãšã€

$$
\begin{aligned}
\Bbb A => Unit &= 1 ^ \Bbb A \\
                &= 1 \\
                &= \Bbb Unit \\
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
ã©ã‚“ãª`A`ã«å¯¾ã—ã¦ã‚‚`Unit`ã‚’è¿”ã™ãªã‚‰ã°ã€ãã‚Œã¯è¡¨ç¾åŠ›ã¨ã—ã¦ã¯ãŸã ã®`Unit`ã¨å¤‰ã‚ã‚Šãªã„ã¨ã„ã†ã“ã¨ã ã€‚

é€†ã«ã—ã¦è€ƒãˆã¦ã¿ã‚‹ã¨ã€

$$
\begin{aligned}
\Bbb Unit => A &= \Bbb A ^ 1 \\
            &= \Bbb A
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
å¼•æ•°ãŒå¸¸ã«`Unit`ã®å”¯ä¸€ã®å€¤`()`å›ºå®šãªã‚‰ã°ã‚ã¨ã¯`A`ã®ã©ã‚Œã‹ã®è¦ç´ ã‚’è¿”ã™ã ã‘ã€ã¤ã¾ã‚ŠãŸã `A`ã®è¦ç´ ã‹ã‚‰ä¸€ã¤ã‚’é¸ã‚“ã§ãã‚‹ã®ã«ç­‰ã—ã„ã€‚

#### æŒ‡æ•°æ³•å‰‡
é–¢æ•°è¡¨ç¾ã§ã®æŒ‡æ•°æ³•å‰‡ã‚’ç¢ºã‹ã‚ã¦ã¿ã‚‹ã€‚

ã¾ãš$(B * C) ^ A = B ^ A * C ^ A$ã«å¯¾å¿œã™ã‚‹ã‚‚ã®ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€

$$
\begin{aligned}
\Bbb A => Tuple2[B, C] &= \Bbb Tuple2[B, C] ^ \Bbb A \\
                        &= \Bbb Tuple2[B * C] ^ \Bbb A \\
                        &= \Bbb (\Bbb B * \Bbb C) ^ \Bbb A \\
                        &= \Bbb B ^ \Bbb A * \Bbb C ^ \Bbb A \\
                        &= \Bbb Tuple2[A => B, A => C]
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
æœ€åˆã®å½¢ã®ã»ã†ãŒé©ç”¨ã¯ç°¡å˜ã ãŒã€ãŸã—ã‹ã«ã‚¿ãƒ—ãƒ«ã«å…¥ã£ãŸåˆ¥ã€…ã®é–¢æ•°ã«å„ã€…`A`å‹ã®å€¤ã‚’é©ç”¨ã—ã¦ã‚‚è¡¨ç¾åŠ›ã¨ã—ã¦ã¯åŒã˜ã§ã‚ã‚‹ã€‚

æ¬¡ã«$C ^ {(A * B)} = (C ^ A) ^ B$ã«å¯¾å¿œã™ã‚‹ã‚‚ã®ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€

$$
\begin{aligned}
\Bbb Tuple2[A, B] => C &= {\Bbb C} ^ {\Bbb Tuple2[A, B]} \\
            &= \Bbb C ^ {(\Bbb A * \Bbb B)} \\
            &= (\Bbb C ^ \Bbb A) ^ \Bbb B \\
            &= \Bbb B => A => C
\end{aligned}
$$

ã¨ãªã‚‹ã€‚
ã“ã®äº‹å®Ÿã¯æœ¬å½“ã«é¢ç™½ãã¦ã€ã‚«ãƒªãƒ¼åŒ–ã•ã‚ŒãŸé–¢æ•°ã¨ã‚«ãƒªãƒ¼åŒ–ã™ã‚‹å‰ã®é–¢æ•°ãŒæœ¬è³ªçš„ã«ã¯åŒã˜ã§ã‚ã‚‹ã¨ã„ã†äº‹å®ŸãŒæŒ‡æ•°æ³•å‰‡ã«å¯¾å¿œã™ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã€‚

### List
`List`ãŒã©ã†ã„ã†è¨ˆç®—ä½“ç³»ã«å¯¾å¿œã™ã‚‹ã‹ã‚’è¦‹ã¦ã„ããŸã„ã€‚
ã¾ãš`List`ã®å®šç¾©ã¯ä»¥ä¸‹ã®ã‚ˆã†ã€‚

```scala
sealed trait List[A]
case class Cons[A](head: A, next: List[A]) extends List[A]
case object Nil extends List[Nothing]
```

ã“ã®ãƒ‡ãƒ¼ã‚¿å‹ã®å®šå¼åŒ–ã¯ã©ã†ãªã‚‹ã ã‚ã†ï¼Ÿ

ã¾ãš`List`ã¯`Cons`ã¨`Nil`ã®ç›´å’Œãªã®ã§ä»¥ä¸‹ãŒæˆã‚Šç«‹ã¤ã€‚

$$
\Bbb List[A] = \Bbb Nil + \Bbb Cons[A]
$$

ãã—ã¦`Cons`ã¯`head`ã¨`next`ã®ç›´ç©ãªã®ã§,

$$
\Bbb Nil + \Bbb Cons[A] = \Bbb Nil + \Bbb A * \Bbb List[A]
$$

ãŒæˆã‚Šç«‹ã¤ã€‚
æ›´ã«ã“ã‚Œã‚‰ã‚’ç¹°ã‚Šè¿”ã—é©ç”¨ã™ã‚‹ã¨ã€

$$
\begin{aligned}
\Bbb List[A] &= \Bbb Nil + \Bbb Cons[A] \\
            &= \Bbb Nil + \Bbb A * \Bbb List[A] \\
            &= \Bbb Nil + \Bbb A * (\Bbb Nil + \Bbb Cons[A]) \\
            &= \Bbb Nil + \Bbb A * \Bbb Nil + \Bbb A * \Bbb Cons[A] \\
            &= \Bbb Nil + \Bbb A * \Bbb Nil + \Bbb A ^ 2 * \Bbb (\Bbb List[A]) \\
            &= \Bbb Nil + \Bbb A * \Bbb Nil + \Bbb A ^ 2 * \Bbb Nil + \Bbb A ^ 3 * \Bbb Nil ... \\
            &= 1 + \Bbb A + \Bbb A ^ 2 + \Bbb A ^ 3 + ... (\because \Bbb Nil = 1)
\end{aligned}
$$

ã®ã‚ˆã†ã«ç„¡é™ç´šæ•°ã«ãªã‚‹ã€‚
ä½•ã˜ã‚ƒã“ã‚Šã‚ƒã¨æ€ãˆã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å‹ã«å¯¾å¿œã•ã›ã¦ã¿ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã€‚
`List`ã¯ãã‚‚ãã‚‚ã©ã‚“ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã ã£ãŸã‹ã¨è¨€ã†ã¨ã€ä»»æ„ã®é•·ã•ã®`A`ã®è¦ç´ ã‚’ä¸¦ã¹ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚
ä¾‹ãˆã°ç©ºã£ã½ã®`List`=`List()`ã¯ãŸã ä¸€é€šã‚Šã—ã‹å­˜åœ¨ã—ãªã„ã€‚
é•·ã•ãŒ1ã®`List`ã¯`A`ã®ã©ã®è¦ç´ ã‚’ä¸€ã¤æ ¼ç´ã™ã‚‹ã‹ã§$\Bbb A$é€šã‚Šã‚ã‚‹ã€‚
é•·ã•2ã®å ´åˆã¯ï¼‘ã¤ç›®ã®æ ¼ç´ã™ã‚‹è¦ç´ ãŒã©ã‚Œã‹ã§$\Bbb A$é€šã‚Šã€ï¼’ã¤ç›®ã‚‚åŒæ§˜ã«$\Bbb A$é€šã‚Šã‚ã‚‹ã‹ã‚‰å…¨ä½“ã¨ã—ã¦$\Bbb A ^ 2$
...
é•·ã•nã®å ´åˆã¯åŒæ§˜ã«$\Bbb A ^ n$é€šã‚Šã€‚
ã¨ã„ã†æ„Ÿã˜ã«ãªã‚‹ã€‚
ã¤ã¾ã‚Š$1 + \Bbb A + \Bbb A ^ 2 + \Bbb A ^ 3 + ...$ã®å„é …ã¯`List`ã®é•·ã•ã«å¿œã˜ãŸãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚

ã•ã¦


## å‚è€ƒ
- [The algebra (and calculus!) of algebraic data types](https://codewords.recurse.com/issues/three/algebra-and-calculus-of-algebraic-data-types)
- [Why do functional programmers always talk about algebra(s)?](https://arosien.github.io/fp-and-algebras/#1)
- [Zippers, Part 2: Zippers as Derivatives](https://pavpanchekha.com/blog/zippers/derivative.html#sec-2)
- [ä»£æ•°çš„ãƒ‡ãƒ¼ã‚¿å‹ã¨åˆç­‰ä»£æ•°å­¦ - ryota-kaâ€™s blog](https://ryota-ka.hatenablog.com/entry/2018/07/09/110000#f-f0ff00a3)
- [The Algebra of Algebraic Data Types](https://about.chatroulette.com/posts/algebraic-data-types/)





